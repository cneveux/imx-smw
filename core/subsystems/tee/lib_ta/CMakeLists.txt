include(GNUInstallDirs)

set(TA_LIBNAME libsmw_ta)
set(TA_LIB_CMD make -C ${CMAKE_CURRENT_SOURCE_DIR}
	        TA_LIBNAME=${TA_LIBNAME}
		TA_DEV_KIT_DIR=${TA_DEV_KIT_DIR}
                CROSS_COMPILE=${CROSS_COMPILE}
		CFG_TEE_TA_LOG_LEVEL=${VERBOSE}
		O=${CMAKE_CURRENT_BINARY_DIR}
		LIB_DIR=${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_LIBDIR}
		INCLUDE_DIR=${CMAKE_BINARY_DIR}/${CMAKE_INSTALL_INCLUDEDIR})

add_custom_target(${TA_LIBNAME}
	COMMAND ${TA_LIB_CMD}
	BYPRODUCTS ${CMAKE_CURRENT_BINARY_DIR}
	COMMENT "Build ${TA_LIBNAME}")

add_dependencies(${PROJECT_NAME} ${TA_LIBNAME})
